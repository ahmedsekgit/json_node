{"version":3,"sources":["../src/QueryTokenizer.js"],"names":["tokenizeQuery","query","keys","tokens","searchTokenRegex","RegExp","join","token","exec","q","groups","key","k","isNegate","n","undefined","push"],"mappings":";;;;;;;AAAe,SAASA,aAAT,CAAwBC,KAAxB,EAA+BC,IAA/B,EAAqC;AAClD,QAAMC,MAAM,GAAG,EAAf;AACA;AACF;AACA;AACA;AACA;AACA;AACA;;AACE,QAAMC,gBAAgB,GAAG,IAAIC,MAAJ,CAAY,mBAAkBH,IAAI,CAACI,IAAL,CAAU,GAAV,CAAe,yCAA7C,EAAuF,IAAvF,CAAzB;AAEA,MAAIC,KAAJ;;AACA,SAAO,CAACA,KAAK,GAAGH,gBAAgB,CAACI,IAAjB,CAAsBP,KAAtB,CAAT,MAA2C,IAAlD,EAAwD;AACtD,UAAMQ,CAAC,GAAGF,KAAK,CAAC,CAAD,CAAL,IAAYA,KAAK,CAAC,CAAD,CAAjB,IAAwBA,KAAK,CAACG,MAAN,CAAaD,CAA/C;AACA,UAAME,GAAG,GAAGJ,KAAK,CAACG,MAAN,CAAaE,CAAzB;AACA,UAAMC,QAAQ,GAAGN,KAAK,CAACG,MAAN,CAAaI,CAAb,KAAmBC,SAApC;AACAZ,IAAAA,MAAM,CAACa,IAAP,CAAY;AAAEP,MAAAA,CAAF;AAAKE,MAAAA,GAAL;AAAUE,MAAAA;AAAV,KAAZ;AACD;;AACD,SAAOV,MAAP;AACD","sourcesContent":["export default function tokenizeQuery (query, keys) {\r\n  const tokens = []\r\n  /* inspired by https://stackoverflow.com/a/366532/3559463\r\n   * regex named groups:\r\n   *   n: captures negate (symbol - exists or not)\r\n   *   q: captures actual query (exlcuding ' or \")\r\n   *        capture groups 4 and 5 also capture the query\r\n   *   k: captures searched key (in queries like key:something)\r\n   */\r\n  const searchTokenRegex = new RegExp(`(?<n>-)?(?:(?<k>${keys.join('|')}):)?(?<q>\"([^\"]*)\"|'([^']*)'|[^\\\\s\"']+)`, 'ig')\r\n\r\n  let token\r\n  while ((token = searchTokenRegex.exec(query)) !== null) {\r\n    const q = token[5] || token[4] || token.groups.q\r\n    const key = token.groups.k\r\n    const isNegate = token.groups.n !== undefined\r\n    tokens.push({ q, key, isNegate })\r\n  }\r\n  return tokens\r\n}\n"],"file":"QueryTokenizer.js"}